<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="ScreenOrientation" content="autoRotate:disabled">
        <link href="https://api.fontshare.com/v2/css?f[]=chubbo@400&f[]=stardom@400&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="style.css">
        <title>Wedding Quiz &ndash; Emily & Billy 2023</title>
    </head>
    <body>
        <div class="quiz-container">
            <div class="quiz">
                <div class="questions">
                    <!-- <div class="question">
                        <h2 class="question__title">Question 1</h2>
                        <p class="question__text">Whose wedding even is this...?</p>
                        <div class="question__answers">
                            <label class="question__answer">
                                <input type="radio" name="question1" />
                                <span class="radio-handle"></span>
                                <span class="question__answer-text">Emily &amp; Billy</span>
                                <svg viewBox="0 0 24 24" class="line-icon">
                                    <polyline points="20 7 10 17 5 12" />
                                </svg>
                            </label>
                            <label class="question__answer">
                                <input type="radio" name="question1" />
                                <span class="radio-handle"></span>
                                <span class="question__answer-text">Somebody's...</span>
                            </label>
                            <label class="question__answer">
                                <input type="radio" name="question1" />
                                <span class="radio-handle"></span>
                                <span class="question__answer-text">Wedding?</span>
                            </label>
                            <label class="question__answer">
                                <input type="radio" name="question1" />
                                <span class="radio-handle"></span>
                                <span class="question__answer-text">I'm just here for the cake</span>
                            </label>
                        </div>
                    </div> -->
                </div>
                <button id="submit" class="bootan" disabled>Submit</button>
                <div class="final-screen" style="display: none;">
                    <svg viewBox="0 0 128 24" class="line-icon divider">
                        <line x1="1" y1="12" x2="127" y2="12" />
                        <line x1="9" y1="18" x2="15" y2="12" />
                        <line x1="9" y1="6" x2="15" y2="12" />
                        <line x1="17" y1="18" x2="23" y2="12" />
                        <line x1="17" y1="6" x2="23" y2="12" />
                        <line x1="25" y1="18" x2="31" y2="12" />
                        <line x1="25" y1="6" x2="31" y2="12" />
                        <line x1="119" y1="18" x2="113" y2="12" />
                        <line x1="119" y1="6" x2="113" y2="12" />
                        <line x1="111" y1="18" x2="105" y2="12" />
                        <line x1="111" y1="6" x2="105" y2="12" />
                        <line x1="103" y1="18" x2="97" y2="12" />
                        <line x1="103" y1="6" x2="97" y2="12" />
                    </svg>
                    <h2 class="final-screen__heading">You got <span class="final-screen__score">0</span> out of <span class="final-screen__total">0</span> correct!</h2>
                    <p class="final-screen__text">Thank you for playing, but an <em>even bigger</em> thank you for coming to celebrate our big day with us!</p>
                    <button class="bootan" style="margin-top: 2rem;">
                        Play Again
                        <svg viewBox="0 0 24 24" class="line-icon" style="margin-left: 1rem;">
                            <line x1="5" y1="12" x2="19" y2="12" />
                            <line x1="13" y1="18" x2="19" y2="12" />
                            <line x1="13" y1="6" x2="19" y2="12" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <div class="modal" data-modal-active="false">
            <div class="modal-content">
                <div class="billy-and-emily">
                    <div id="emily" data-state="yay">
                        <img class="body" src="dress.svg" alt="">
                        <div class="arm--left">
                            <div class="forearm--left">
                                <div class="hand"></div>
                            </div>
                        </div>
                        <div class="arm--right">
                            <div class="forearm--right">
                                <div class="hand"></div>
                            </div>
                        </div>
                        <img class="head" src="emily-head-sm.png" alt="Billy's head" />
                    </div>
                    <div id="billy" data-state="yay">
                        <img class="body" src="suit.svg" alt="">
                        <div class="arm--left">
                            <div class="forearm--left">
                                <div class="hand"></div>
                            </div>
                        </div>
                        <div class="arm--right">
                            <div class="forearm--right">
                                <div class="hand"></div>
                            </div>
                        </div>
                        <img class="head" src="billy-head-sm.png" alt="Billy's head" />
                    </div>
                </div>
                <div class="modal-content__card">
                    <div class="modal-content__card-border">
                        <h2 class="modal-content__heading">Correct!</h2>
                        <p class="modal-content__words-n-stuff">This is some flavor text.</p>
                        <button class="bootan" style="margin-top: 2rem;">
                            Next
                            <svg viewBox="0 0 24 24" class="line-icon" style="margin-left: 1rem;">
                                <line x1="5" y1="12" x2="19" y2="12" />
                                <line x1="13" y1="18" x2="19" y2="12" />
                                <line x1="13" y1="6" x2="19" y2="12" />
                            </svg>
                        </button>
                    </div>
                    <img class="branch1" src="branch1.png" alt="">
                    <img class="branch2" src="branch2.png" alt="">
                </div>
            </div>
        </div>
        <script>
            // -------------------------------------------------------------- //
            // Questions logic                                                //
            // -------------------------------------------------------------- //

            let currentQuestion = 0;
            const questions = [
                {
                    question: 'Let’s start off with an easy one... whose wedding even is this?',
                    correctAnswer: 0,
                    answers: [
                        {
                            text: 'Emily & Billy',
                            modalText: 'Good thing you paid attention to the names on the invite!'
                        },
                        {
                            text: 'Kanye & Kim Kardashian',
                            modalText: 'It’s not Kanye and Kim, but let’s be real here, Kanye and Kim <em>wish</em> they had a wedding this awesome.' },
                        {
                            text: 'Somebody’s...',
                            modalText: 'Technically correct, just not the correct-est. But don’t worry, you’ll still get a slice of the cake.'
                        },
                        {
                            text: 'I’m just here for the cake',
                            modalText: 'You’re here for the cake, yes, but you’re also here for the love.'
                        }
                    ],
                },
                {
                    question: 'When did Emily and Billy first meet?',
                    correctAnswer: 2,
                    answers: [
                        {
                            text: '1999, at a Y2K party',
                            modalText: 'Filler text.'
                        },
                        {
                            text: '2012, at an end-of-the-world party',
                            modalText: 'Thankfully the world didn’t end in 2012, othwerwise they wouldn’t have met in 2019.'
                        },
                        {
                            text: '2019, just before Christmas',
                            modalText: 'December 21, 2019! It was also right before the end of the world in 2020, but that’s a whole ’nother story...<br /><br />Talk about good timing though!'
                        },
                        {
                            text: 'Last week',
                            modalText: 'Filler text.'
                        }
                    ],
                },
                {
                    question: 'On one of their first dates, Emily took Billy to an activity she loves (and he had never done before). What was it?',
                    correctAnswer: 3,
                    answers: [
                        {
                            text: 'Skydiving',
                            modalText: 'Neither have been skydiving yet, but now that you mention it... think Emily would be down?'
                        },
                        {
                            text: 'M-m-m-monster Jam!',
                            modalText: 'They actually <em>did</em> go to Monster Jam once (dressed as rednecks, of course), but huge, loud trucks aren’t exactly a “love” of Emily’s.'
                        },
                        {
                            text: 'Going to watch the sun rise',
                            modalText: 'Not a bad guess, though, since Billy is practically never up that early.'
                        },
                        {
                            text: 'A spin class',
                            modalText: 'Emily is a cardio queen, but Billy’s cardio consists of walking from the couch to the fridge. He kept a poker face, powered through, and managed to not pass out.'
                        }
                    ],
                },
                {
                    question: 'For the proposal, what object did Billy 3D print to hide the real diamond ring inside of?',
                    correctAnswer: 1,
                    answers: [
                        {
                            text: 'A puzzle box',
                            modalText: 'He <em>did</em> give her a puzzle box for her birthday a month before the proposal, but alas, it had no ring inside.'
                        },
                        {
                            text: 'A ring pop candy',
                            modalText: 'He’d been teasing her about getting her a ring pop for months, so when he finally did, she wasn’t sure it was for real until the top popped off showing the diamond inside.'
                        },
                        {
                            text: 'A goose',
                            modalText: 'So close yet, so far! While it wasn’t an entire 3D printed goose, the 3D printed ring pop she got <em>did</em> have a goose silhouette on it.',
                        },
                        {
                            text: 'A Tessearact',
                            modalText: 'The proposal Billy pulled off sure felt like playing 4D chess, but he still couldn’t 3D print a 4D box.'
                        }
                    ],
                }
            ];

            const submitButton = document.querySelector('#submit');

            function addCurrentQuestion() {
                const question = questions[currentQuestion];
                const questionDiv = document.createElement('div');
                const questionTitle = document.createElement('h2');
                const questionText = document.createElement('p');
                const questionAnswers = document.createElement('div');

                questionDiv.classList.add('question');
                questionTitle.classList.add('question__title');
                questionTitle.textContent = `Question ${currentQuestion + 1}`;
                questionText.classList.add('question__text');
                questionText.textContent = question.question;
                questionAnswers.classList.add('question__answers');

                question.answers.forEach((answer, index) => {
                    const questionAnswer = document.createElement('label');
                    const questionAnswerInput = document.createElement('input');
                    const questionAnswerHandle = document.createElement('span');
                    const questionAnswerText = document.createElement('span');
                    
                    questionAnswer.classList.add('question__answer');
                    questionAnswerInput.type = 'radio';
                    questionAnswerInput.name = `question${currentQuestion}`;
                    questionAnswerHandle.classList.add('radio-handle');
                    questionAnswerText.classList.add('question__answer-text');
                    questionAnswerText.textContent = answer.text;

                    questionAnswer.appendChild(questionAnswerInput);
                    questionAnswer.appendChild(questionAnswerHandle);
                    questionAnswer.appendChild(questionAnswerText);

                    questionAnswers.appendChild(questionAnswer);

                    questionAnswerInput.addEventListener('change', () => {
                        submitButton.removeAttribute('disabled');
                    });
                });

                questionDiv.appendChild(questionTitle);
                questionDiv.appendChild(questionText);
                questionDiv.appendChild(questionAnswers);

                document.querySelector('.questions').appendChild(questionDiv);
            };

            // Add the first question on page load
            addCurrentQuestion();

            // -------------------------------------------------------------- //
            // Modal logic                                                    //
            // -------------------------------------------------------------- //

            const closeModalButton = document.querySelector('.modal-content__card button');
            const modal = document.querySelector('.modal');
            const modalActive = modal.dataset.modalActive;
            const modalContentHeading = document.querySelector('.modal-content__heading');
            const modalContentText = document.querySelector('.modal-content__words-n-stuff');
            const correctHeadings = [
                'Correct!',
                'You got it!',
                'That’s right!',
                'You’re right!',
                'Bingo!',
                'Nailed it!',
                'You are so, so right.'
            ]
            const incorrectHeadings = [
                'Not quite, sorry!',
                'Uh oh, wrong!',
                'Uh oh, incorrect!',
                'Oops, incorrect!',
                'Incorrect, sorry!',
                'Close, but completely wrong.'
            ];

            submitButton.addEventListener('click', () => {
                const chosenAnswer = document.querySelector(`.question:nth-child(${currentQuestion + 1}) input:checked ~ .question__answer-text`);
                if (chosenAnswer) {
                    const chosenAnswerText = chosenAnswer.textContent;
                    const correctAnswer = questions[currentQuestion].correctAnswer;

                    // Pick a random 'correct' modal heading if it's correct
                    if (chosenAnswerText === questions[currentQuestion].answers[correctAnswer].text) {
                        modalContentHeading.textContent = correctHeadings[Math.floor(Math.random() * incorrectHeadings.length)];
                    }

                    // Otherwise, if it's wrong, pick a random 'incorrect' modal heading
                    else {
                        modalContentHeading.textContent = incorrectHeadings[Math.floor(Math.random() * incorrectHeadings.length)];
                    }

                    // Get the index of the chosen answer
                    const chosenAnswerIndex = questions[currentQuestion].answers.findIndex(answer => answer.text === chosenAnswerText);

                    // Add the modal text and show the modal
                    modalContentText.innerHTML = questions[currentQuestion].answers[chosenAnswerIndex].modalText;

                    // Show the modal
                    modal.dataset.modalActive = true;
                }
            });

            closeModalButton.addEventListener('click', () => {
                console.log('closing modal');

                // Add the disabled class to the current question div
                document.querySelectorAll('.question')[currentQuestion].classList.add('disabled');

                // Add the disabled attribute to each input in the current question
                document.querySelectorAll(`.question:nth-child(${currentQuestion + 1}) input`).forEach(input => {
                    input.disabled = true;
                });

                // Add the checkmark icon to the correct answer
                const question = questions[currentQuestion];
                const questionAnswers = document.querySelectorAll(`.question:nth-child(${currentQuestion + 1}) .question__answer`);
                const questionAnswer = questionAnswers[question.correctAnswer];
                const questionAnswerIcon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                const questionAnswerCheckmark = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');

                questionAnswerIcon.classList.add('line-icon');
                questionAnswerIcon.setAttribute('viewBox', '0 0 24 24');
                questionAnswerCheckmark.setAttribute('points', '20 7 10 17 5 12');
                questionAnswerIcon.appendChild(questionAnswerCheckmark);
                questionAnswer.appendChild(questionAnswerIcon);

                // Close the modal
                modal.dataset.modalActive = false;

                // Disable the submit button again until an answer for the new question is chosen
                submitButton.setAttribute('disabled', true);

                // If there is another question, increment to the new question and add its content
                if (currentQuestion < questions.length - 1) {
                    currentQuestion++;
                    addCurrentQuestion();
                }

                // Else, if there are no more questions, remove the submit button and show the final screen
                else {
                    submitButton.style.display = 'none';

                    // Tally up the total number of answers selected that were correct
                    let correctAnswers = 0;
                    questions.forEach((question, index) => {
                        const chosenAnswer = document.querySelector(`.question:nth-child(${index + 1}) input:checked ~ .question__answer-text`);
                        if (chosenAnswer) {
                            const chosenAnswerText = chosenAnswer.textContent;
                            const correctAnswer = questions[index].correctAnswer;
                            if (chosenAnswerText === questions[index].answers[correctAnswer].text) {
                                correctAnswers++;
                            }
                        }
                    });

                    // Show the final score
                    document.querySelector('.final-screen__score').textContent = correctAnswers;

                    // Show the total number of questions
                    document.querySelector('.final-screen__total').textContent = questions.length;

                    // Show the final screen
                    document.querySelector('.final-screen').style.display = 'block';
                }

                // Scroll to the new question
                window.scrollTo({ top: document.body.scrollHeight })
            });
        </script>
    </body>
</html>